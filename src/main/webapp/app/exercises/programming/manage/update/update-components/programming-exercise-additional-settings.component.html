<div
    *ngIf="
        !programmingExerciseUpdateService.config.shouldHidePreview ||
        (programmingExerciseUpdateService.config.programmingExercise.title && programmingExerciseUpdateService.config.programmingExercise.shortName)
    "
>
    <div class="form-group mt-2 mb-0">
        <label class="label-narrow" jhiTranslate="artemisApp.programmingExercise.preview.label">
            <jhi-help-icon text="artemisApp.programmingExercise.preview.tooltip"></jhi-help-icon>
        </label>
    </div>
    <jhi-programming-exercise-plans-and-repositories-preview
        [programmingExercise]="programmingExerciseUpdateService.config.programmingExercise"
    ></jhi-programming-exercise-plans-and-repositories-preview>
    <div *ngIf="!programmingExerciseUpdateService.config.isImport && programmingExerciseUpdateService.config.auxiliaryRepositoriesSupported" class="form-group">
        <ngx-datatable
            id="auxiliaryRepositoryTable"
            class="bootstrap"
            trackByProp="id"
            [headerHeight]="50"
            [limit]="20"
            [columnMode]="'force'"
            [rowHeight]="'auto'"
            [rows]="programmingExerciseUpdateService.config.programmingExercise.auxiliaryRepositories"
            *ngIf="
                programmingExerciseUpdateService.config.programmingExercise.auxiliaryRepositories &&
                programmingExerciseUpdateService.config.programmingExercise.auxiliaryRepositories.length > 0
            "
        >
            <ngx-datatable-column name="Repository Name" prop="repositoryName">
                <ng-template ngx-datatable-cell-template let-row="row">
                    <jhi-table-editable-field
                        [id]="row.id + '-repositoryName'"
                        [value]="row.name || ''"
                        [onValueUpdate]="programmingExerciseUpdateService.config.updateRepositoryName(row)"
                        [pattern]="programmingExerciseUpdateService.config.invalidRepositoryNamePattern"
                        [isRequired]="true"
                        [translationBase]="'artemisApp.programmingExercise.auxiliaryRepository.repositoryNameRequired'"
                    >
                    </jhi-table-editable-field>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Checkout Directory" prop="checkoutDirectory">
                <ng-template ngx-datatable-cell-template let-row="row">
                    <jhi-table-editable-field
                        [id]="row.id + '-checkoutDirectory'"
                        [value]="row.checkoutDirectory || ''"
                        [onValueUpdate]="programmingExerciseUpdateService.config.updateCheckoutDirectory(row)"
                        [pattern]="programmingExerciseUpdateService.config.invalidDirectoryNamePattern"
                        [translationBase]="'artemisApp.programmingExercise.auxiliaryRepository.invalidDirectoryName'"
                    >
                    </jhi-table-editable-field>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Description" prop="description">
                <ng-template ngx-datatable-cell-template let-row="row">
                    <textarea class="form-control table-editable-field__input me-2" [id]="row.id + '-description'" [(ngModel)]="row.description" name="description"> </textarea>
                </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="" prop="removeButton">
                <ng-template ngx-datatable-cell-template let-row="row">
                    <jhi-remove-auxiliary-repository-button
                        placement="right auto"
                        [programmingExercise]="programmingExerciseUpdateService.config.programmingExercise"
                        (onRefresh)="programmingExerciseUpdateService.config.refreshAuxiliaryRepositoryChecks()"
                        [row]="row"
                        class="ml-2"
                    ></jhi-remove-auxiliary-repository-button>
                </ng-template>
            </ngx-datatable-column>
        </ngx-datatable>
        <ngb-alert
            [dismissible]="false"
            [type]="'danger'"
            *ngIf="programmingExerciseUpdateService.config.auxiliaryRepositoryDuplicateNames || programmingExerciseUpdateService.config.auxiliaryRepositoryDuplicateDirectories"
        >
            <span *ngIf="programmingExerciseUpdateService.config.auxiliaryRepositoryDuplicateNames">{{
                'artemisApp.programmingExercise.auxiliaryRepository.duplicateRepositoryNames' | artemisTranslate
            }}</span>
            <span *ngIf="programmingExerciseUpdateService.config.auxiliaryRepositoryDuplicateDirectories">{{
                'artemisApp.programmingExercise.auxiliaryRepository.duplicateDirectoryNames' | artemisTranslate
            }}</span>
        </ngb-alert>
        <ngb-alert [dismissible]="false" [type]="'info'" *ngIf="programmingExerciseUpdateService.config.isEdit">
            <span>{{ 'artemisApp.programmingExercise.auxiliaryRepository.warning' | artemisTranslate }}</span>
        </ngb-alert>
        <jhi-add-auxiliary-repository-button
            [programmingExercise]="programmingExerciseUpdateService.config.programmingExercise"
            (onRefresh)="programmingExerciseUpdateService.config.refreshAuxiliaryRepositoryChecks()"
            class="ml-2"
        ></jhi-add-auxiliary-repository-button>
    </div>
</div>

<div class="form-group mb-0">
    <div class="form-check">
        <label [class]="!programmingExerciseUpdateService.config.validIdeSelection() ? 'form-check-label text-danger' : 'form-check-label'" for="field_allowOfflineIde">
            <input
                class="form-check-input"
                type="checkbox"
                name="allowOfflineIde"
                id="field_allowOfflineIde"
                [(ngModel)]="programmingExerciseUpdateService.config.programmingExercise.allowOfflineIde"
                checked
            />
            <span jhiTranslate="artemisApp.programmingExercise.allowOfflineIde.title">Allow Offline IDE</span>
            <fa-icon
                *ngIf="!programmingExerciseUpdateService.config.validIdeSelection()"
                [icon]="faQuestionCircle"
                class="text-danger"
                [placement]="'top'"
                ngbTooltip="{{ 'artemisApp.programmingExercise.allowOfflineIde.alert' | artemisTranslate }}"
            ></fa-icon>
        </label>
    </div>
</div>

<div class="form-group mb-0" *ngIf="ProjectType.XCODE !== programmingExerciseUpdateService.config.selectedProjectType">
    <div class="form-check">
        <label [class]="!programmingExerciseUpdateService.config.validIdeSelection() ? 'form-check-label text-danger' : 'form-check-label'" for="field_allowOnlineEditor">
            <input
                class="form-check-input"
                type="checkbox"
                name="allowOnlineEditor"
                id="field_allowOnlineEditor"
                [(ngModel)]="programmingExerciseUpdateService.config.programmingExercise.allowOnlineEditor"
                checked
            />
            <span jhiTranslate="artemisApp.programmingExercise.allowOnlineEditor.title">Allow Online Editor</span>
            <fa-icon
                *ngIf="!programmingExerciseUpdateService.config.validIdeSelection()"
                [icon]="faQuestionCircle"
                class="text-danger"
                [placement]="'top'"
                ngbTooltip="{{ 'artemisApp.programmingExercise.allowOnlineEditor.alert' | artemisTranslate }}"
            ></fa-icon>
        </label>
    </div>
</div>

<div class="form-group mb-0">
    <div class="form-check">
        <label class="form-check-label" for="field_showTestNamesToStudents">
            <input
                class="form-check-input"
                type="checkbox"
                name="showTestNamesToStudents"
                id="field_showTestNamesToStudents"
                [(ngModel)]="programmingExerciseUpdateService.config.programmingExercise.showTestNamesToStudents"
                checked
            />
            <span jhiTranslate="artemisApp.programmingExercise.showTestNamesToStudents">Show Test Names to Students</span>
            <fa-icon
                [icon]="faQuestionCircle"
                class="text-secondary"
                placement="auto"
                ngbTooltip="{{ 'artemisApp.programmingExercise.showTestNamesToStudentsTooltip' | artemisTranslate }}"
            ></fa-icon>
        </label>
    </div>
</div>

<div class="form-group mb-0" *ngIf="programmingExerciseUpdateService.config.publishBuildPlanUrlAllowed">
    <div class="form-check">
        <label class="form-check-label" for="field_publishBuildPlanUrl">
            <input
                class="form-check-input"
                type="checkbox"
                name="publishBuildPlanUrl"
                id="field_publishBuildPlanUrl"
                [(ngModel)]="programmingExerciseUpdateService.config.programmingExercise.publishBuildPlanUrl"
                checked
            />
            <span jhiTranslate="artemisApp.programmingExercise.publishBuildPlanUrl">Publish Build Plan Url</span>
        </label>
    </div>
</div>
